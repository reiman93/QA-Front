"use strict";(self.webpackChunkQASystem=self.webpackChunkQASystem||[]).push([[8248],{8248:(V,h,o)=>{o.r(h),o.d(h,{ListModule:()=>w});var u=o(9808),g=o(1083),t=o(5e3),v=o(7511),A=o(7886),x=o(651),C=o(3851),Z=o(3424),y=o(3737),S=o(5801),T=o(4366),D=o(7115),L=o(4673),M=o(8966),m=o(9386),f=o(4999),k=o(7423),b=o(9814);const O=["tabla"],N=["pre"];function U(i,s){if(1&i&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&i){const e=s.$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function J(i,s){if(1&i&&(t.TgZ(0,"td",20),t.TgZ(1,"span",21),t._uU(2),t.qZA(),t.qZA()),2&i){const e=s.$implicit,a=t.oxw();t.xp6(1),t.Q6J("ngClass",a.stateClass[e.id]),t.xp6(1),t.Oqu(e.state)}}function B(i,s){if(1&i&&(t.TgZ(0,"td",22),t._UZ(1,"img",23),t._uU(2),t.qZA()),2&i){const e=s.$implicit,a=t.oxw();t.xp6(1),t.s9C("src",a.foto[e.id],t.LSH),t.xp6(1),t.hij(" ",e.users.name," ")}}function E(i,s){if(1&i&&(t.TgZ(0,"td",20),t._uU(1),t.ALo(2,"date"),t.qZA()),2&i){const e=s.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.date,"yyyy-MM-dd")," ")}}function R(i,s){if(1&i&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&i){const e=s.$implicit;t.xp6(1),t.hij(" ",e.notes," ")}}function _(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"td",24),t.TgZ(1,"div",25),t.TgZ(2,"mat-radio-group"),t.TgZ(3,"mat-radio-button",26),t.NdJ("change",function(r){const l=t.CHM(e).$implicit;return t.oxw().createPreOperation(r,l)})("click",function(r){return r.stopPropagation()}),t._uU(4," Approved "),t.qZA(),t.TgZ(5,"mat-radio-button",27),t.NdJ("click",function(r){const l=t.CHM(e).$implicit,n=t.oxw();return r.stopPropagation(),n.showModal(l)}),t._uU(6," Desapproved "),t.qZA(),t.qZA(),t.qZA(),t.qZA()}}const Y=function(){return[5,10,25,100]},F=[{path:"",component:(()=>{class i{constructor(e,a,r,c,l,n,p,d,q,G){this.dataGridService=e,this.service=a,this.servicioArea=r,this.servicioJanitor=c,this.servicioAction=l,this.servicioDeficiency=n,this.servicioNotificacion=p,this.router=d,this.snakBarService=q,this.dialog=G,this.emitter=new t.vpe,this.hideOptions=!1,this.slectedRows=!0,this.disabled=[],this.fields=[{label:"Notes",model:"",ref:"notes",class:"col-12",type:"text"}],this.stateClass=[],this.foto=[]}emitSelectedValues(e){this.emitter.emit(e)}emitNotifUpdate(e){this.servicioNotificacion.updateNotif()}ngOnInit(){this.getAllJanitor(),this.getAllDeficiency(),this.getAllAction(),this.dataGridService.dataGrid.subscribe(e=>{e instanceof Array&&e.forEach((a,r)=>{this.stateClass[a.id]="Disapproved"==a.state?"badge rounded-pill bg-danger text-dark":"Approved"==a.state?"badge rounded-pill bg-success text-dark":"badge rounded-pill bg-warning text-dark",this.foto[a.id]=a.users&&a.users.foto?a.users.foto:"assets/img/user.png"})})}getAllJanitor(){this.servicioJanitor.getAll("janitor").subscribe({next:e=>{this.dataJanitor=e.data,this.fields.push({label:"Janitor",model:"",ref:"janitor",type:"combobox",class:"col-12",data:this.dataJanitor})},error:e=>{this.snakBarService.openSnackBar("Error getting data.","cerrar",{},"error")},complete:()=>{}})}getAllAction(){this.servicioAction.getAll("relapse_action").subscribe({next:e=>{this.dataAction=e.data,this.fields.push({label:"Corrective actions",model:"",ref:"action",type:"combobox",class:"col-12",data:this.dataAction})},error:e=>{this.snakBarService.openSnackBar("Error getting data.","cerrar",{},"error")},complete:()=>{}})}getAllDeficiency(){this.servicioDeficiency.getAll("deficiency_type").subscribe({next:e=>{this.dataDeficiency=e.data,this.fields.push({label:"Deficiency type",model:"",ref:"deficiency",type:"combobox",class:"col-12",data:this.dataDeficiency})},error:e=>{this.snakBarService.openSnackBar("Error getting data.","cerrar",{},"error")},complete:()=>{}})}ngAfterViewInit(){this.tabla.selection.changed.subscribe(e=>{e.added.forEach(r=>{this.disabled[r]=!1}),e.removed.forEach(r=>{this.disabled[r]=!0}),this.slectedRows=0===e.source.selected.length;const a=new Array;this.result.forEach((r,c)=>{-1!=e.source.selected.indexOf(r.id)&&a.push(r)}),this.emitSelectedValues(a)})}createPreOperation(e,a){const r=this.dialog.open(A.G,{data:{value:1,message:"Are you sure want set "+e.value+" this area?."}});let c="Disapproved"!=a.state?"Aceptable.":"Acceptable with previous incidents.";r.afterClosed().subscribe(l=>{if("accept"==l){let n={id:a.id,aceptable:!0,state:e.value,notes:c,date:a.date,user:JSON.parse(sessionStorage.getItem("currentUser")).username};this.service.addPreOperation(n,"pre_operational").subscribe({next:p=>{this.snakBarService.openSnackBar("Successfully updated","Close"),this.servicioArea.updateState(n,"updateState").subscribe({next:d=>{this.tabla.reloadData(),this.emitNotifUpdate(!0)},error:d=>{},complete:()=>{}})},error:p=>{this.snakBarService.openSnackBar("Error creating data.","cerrar",{},"error")},complete:()=>{}})}else this.clearRadioField(a.id)})}showModal(e){this.clearModalFields(),this.dialog.open(v.L,{data:{title:e.name+":",fields:this.fields}}).afterClosed().subscribe(r=>{let c=!0;if(r){var l={aceptable:!1,id:e.id,date:e.date,user:JSON.parse(sessionStorage.getItem("currentUser")).username};r.forEach((n,p)=>{Object.assign(l,{[n.ref]:n.model}),n.model||(c=!1)}),c?this.service.addPreOperation(l,"pre_operational").subscribe({next:n=>{this.snakBarService.openSnackBar("Successfully updated","Close")},error:n=>{this.snakBarService.openSnackBar("Error creating data.","cerrar",{},"error")},complete:()=>{let n={name:"System Info:",recived:!1,user:JSON.parse(sessionStorage.getItem("currentUser")).username,description:e.name+" was detected with problems.Recheck will be scheduled for 30 to 50 minutes."};this.servicioNotificacion.create(n,"notification").subscribe({next:d=>{this.emitNotifUpdate(!0)},error:d=>{},complete:()=>{}}),this.servicioArea.updateState({id:e.id,state:"Disapproved",notes:"Disapproved "+e.name},"updateState").subscribe({next:d=>{this.tabla.reloadData(),this.emitNotifUpdate(!0)},error:d=>{},complete:()=>{}})}}):(console.warn("ENTRO EN ELSTE ELSE!!!!"),this.snakBarService.openSnackBar("Required fields.","cerrar",{},"error"),this.clearRadioField(e.id))}else this.clearRadioField(e.id)})}clearModalFields(){this.fields.forEach((e,a)=>{e.model=""})}clearRadioField(e){this.resetField=null}radioChange(e){}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(x.A),t.Y36(C.e),t.Y36(Z.T),t.Y36(y.u),t.Y36(S.b),t.Y36(T.S),t.Y36(D.T),t.Y36(g.F0),t.Y36(L.A),t.Y36(M.uw))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-list-equipment"]],viewQuery:function(e,a){if(1&e&&(t.Gf(O,5),t.Gf(N,5)),2&e){let r;t.iGM(r=t.CRH())&&(a.tabla=r.first),t.iGM(r=t.CRH())&&(a.pre=r.first)}},inputs:{hideOptions:"hideOptions"},outputs:{emitter:"emitter",emitSelectedValues:"emitSelectedValues"},decls:29,vars:10,consts:[[1,"row"],["pre",""],[1,"col-12"],[1,"mb-0","text-uppercase"],[1,"card","border-top","border-0","border-4","border-white"],[1,"card-body"],[3,"selectAvailable","serviceData","verticalLine"],["tabla",""],["title","Area","matColumnDef","name","type","string",3,"sort"],["mat-cell","","style","text-align: right",4,"matCellDef"],["title","State","matColumnDef","state","type","string",3,"sort"],["title","QA last reviewer","matColumnDef","users","type","string",3,"sort"],["mat-cell","","style","text-align: left",4,"matCellDef"],["title","Date","matColumnDef","date","type","date",3,"sort"],["title","Notes","matColumnDef","notes","type","string",3,"sort"],[2,"display","none"],["title","Options","matColumnDef","unknow"],["mat-cell","","style","padding-right: 0",4,"matCellDef"],[3,"pageSizeOptions"],["mat-raised-button","","color","warn",3,"click"],["mat-cell","",2,"text-align","right"],[3,"ngClass"],["mat-cell","",2,"text-align","left"],["width","40","height","40","alt","user avatar",1,"rounded-circle","mySpacer",3,"src"],["mat-cell","",2,"padding-right","0"],[1,"col-12",2,"text-align","left"],["value","Approved",1,"margin-toogle",2,"display","inline-block",3,"change","click"],["value","desapp",1,"margin-toogle",2,"display","inline-block",3,"click"]],template:function(e,a){if(1&e){const r=t.EpF();t.TgZ(0,"div",0,1),t.TgZ(2,"div",2),t.TgZ(3,"h6",3),t._uU(4,"Pre Operational Sanitation"),t.qZA(),t._UZ(5,"hr"),t.TgZ(6,"div",4),t.TgZ(7,"div",5),t.TgZ(8,"app-mat-data-table",6,7),t.TgZ(10,"app-mat-column-table",8),t.YNc(11,U,2,1,"td",9),t.qZA(),t.TgZ(12,"app-mat-column-table",10),t.YNc(13,J,3,2,"td",9),t.qZA(),t.TgZ(14,"app-mat-column-table",11),t.YNc(15,B,3,2,"td",12),t.qZA(),t.TgZ(16,"app-mat-column-table",13),t.YNc(17,E,3,4,"td",9),t.qZA(),t.TgZ(18,"app-mat-column-table",14),t.YNc(19,R,2,1,"td",9),t.qZA(),t._UZ(20,"div",15),t.TgZ(21,"app-mat-option-table",16),t.YNc(22,_,7,0,"td",17),t.qZA(),t._UZ(23,"app-mat-paginator-data-table",18),t.TgZ(24,"app-mat-error-data-table"),t._uU(25," There are problems to load data. "),t._UZ(26,"br"),t.TgZ(27,"button",19),t.NdJ("click",function(){return t.CHM(r),t.MAs(9).reloadData()}),t._uU(28," Reload "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}2&e&&(t.xp6(8),t.Q6J("selectAvailable",!1)("serviceData",a.servicioArea)("verticalLine",!0),t.xp6(2),t.Q6J("sort",!0),t.xp6(2),t.Q6J("sort",!0),t.xp6(2),t.Q6J("sort",!0),t.xp6(2),t.Q6J("sort",!0),t.xp6(2),t.Q6J("sort",!0),t.xp6(5),t.Q6J("pageSizeOptions",t.DdM(9,Y)))},directives:[m.Zc,m.PT,f.w1,f.Dz,m.TD,m.y0,m.DV,k.lW,f.ev,u.mk,b.VQ,b.U0],pipes:[u.uU],styles:[".mySpacer[_ngcontent-%COMP%]{margin:.5rem!important}.left-space[_ngcontent-%COMP%]{margin-left:10px}  mat-dialog-container{background:#222b45!important}  mat-dialog-container i{color:#fff!important}  th.mat-header-cell{color:#1a73e861!important}  .mat-radio-button .mat-radio-outer-circle{border-color:#1a73e861!important}  .mat-checkbox .mat-checkbox-ripple .mat-ripple-element{background-color:#1a73e861!important}  .mat-checkbox .mat-checkbox-frame{border-color:#1a73e861!important}  .mat-tooltip-trigger .mat-button-wrapper{color:#1a73e861!important}  .mat-paginator-range-actions .mat-paginator-range-label{color:#1a73e861!important}mat-card-title[_ngcontent-%COMP%]{border-bottom:1px solid black;line-height:36px}.margin-toogle[_ngcontent-%COMP%]{margin-left:2.5px;margin-right:5px}.label-toogle[_ngcontent-%COMP%]{vertical-align:top}.containerToggle[_ngcontent-%COMP%]{display:inline-block;width:130px;vertical-align:top}.dialog-message[_ngcontent-%COMP%]{background-color:#fff}"]}),i})()}];let P=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[g.Bz.forChild(F)],g.Bz]}),i})();var Q=o(6596),j=o(9151);let w=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[u.ez,P,Q.V,j.q]]}),i})()}}]);